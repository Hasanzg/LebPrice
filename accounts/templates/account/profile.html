<!-- templates/account/profile.html -->
{% extends "base.html" %}
{% load static %}
{% block title %} - Your Profile{% endblock %}
{% block extra_head_main %}
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
{% endblock %}
{% block content_main %}
<div class="profile-container">
    <h1>Your Profile</h1>
    <p style="text-align: center; margin-bottom: 32px;">Manage your personal information and preferences</p>
   
    <a href="{% url 'home' %}" class="back-home">Back to Home</a>
   
    <div class="profile-card">
        <form method="POST" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="profile-layout">
                <!-- Profile picture -->
                <div class="profile-picture-section">
                    <img id="profile-preview"
                         src="{% if profile.profile_picture %}{{ profile.profile_picture.url }}{% else %}{% static 'images/default.jpg' %}{% endif %}"
                         alt="Profile Picture">
                    <input type="file" name="profile_picture" id="id_profile_picture" accept="image/*">
                    <label for="id_profile_picture" class="custom-file-upload">
                        Choose Picture
                    </label>
                </div>
                <!-- Profile info -->
                <div class="profile-info-section">
                    <div class="info-row">
                        <label>Username:</label>
                        <span class="read-only">{{ request.user.username }}</span>
                    </div>
                    <div class="info-row">
                        <label>Joined:</label>
                        <span class="read-only">{{ request.user.date_joined|date:'F j, Y' }}</span>
                    </div>
                    <div class="name-row">
                        <div class="info-row">
                            <label>First Name:</label>
                            {{ form.first_name }}
                        </div>
                        <div class="info-row">
                            <label>Last Name:</label>
                            {{ form.last_name }}
                        </div>
                    </div>
                    <div class="info-row">
                        <label>❤️ Favorite Shops:</label>
                        {{ form.favorite_shops }}
                    </div>
                    <div class="info-row">
                        <label>❤️ Favorite Items:</label>
                        {{ form.favorite_items }}
                    </div>
                    <button type="submit" class="save-button">Save Changes</button>
                </div>
            </div>
        </form>
    </div>
</div>
<!-- JS for live preview of newly selected image -->
<script>
  const input = document.getElementById("id_profile_picture");
  const preview = document.getElementById("profile-preview");
  input.addEventListener("change", function() {
    const file = this.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(e) {
        preview.src = e.target.result;
      }
      reader.readAsDataURL(file);
    }
  });
</script>
{% endblock %}